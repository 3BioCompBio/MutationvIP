# outputs/diff_pathogenicity
> This description is AI generated but reviewed by Human

Generated by `notebooks/diff_pathogenicity.ipynb`.

Tests whether the correlation between vIP score and mutational context enrichment (F) differs between pathogenicity categories.
Two databases are used: **CMC** (Cancer Mutation Census, driver vs passenger) and **ClinVar** (Pathogenic vs Benign).
Two context sizes are tested: **triplicate** (3-mer, 32 pyrimidine contexts) and **quintuplet** (5-mer, 512 contexts).

---

## Method

**Enrichment F** is computed per k-mer context and per category as:

$$F = \log\!\left(\frac{\text{mutation count in context} / \text{total mutations in category}}{\text{genome-wide k-mer frequency}}\right)$$

Contexts are standardized to the pyrimidine strand before counting. The **vIP score** for each context is computed with `VIPER.compute_double_strand_score`.

**Pearson r** between vIP and F is then computed across all k-mer contexts, separately for each pathogenicity category (driver/passenger or Pathogenic/Benign). A negative r means vIP anti-correlates with mutation enrichment, i.e. high-vIP contexts accumulate fewer mutations.

**GC-corrected partial r** controls for the number of G+C bases in the context (`gc_count`):

$$r_{corrected}(vIP, F \mid GC) = \frac{r(vIP,F) - r(vIP,GC)\cdot r(F,GC)}{\sqrt{(1-r(vIP,GC)^2)\cdot(1-r(F,GC)^2)}}$$

p-values for the partial r are derived from the t-distribution with n − 3 degrees of freedom.

**Permutation test** (n = 10 000, seed 42): vIP values are permuted across the two categories and the difference in r (or partial r) is recomputed. The two-sided p-value is the fraction of permutations where |Δr_perm| ≥ |Δr_obs|.

---

## Root

### `{context}_{db}_pearsonr.tsv`
Pearson r between vIP and F for each pathogenicity category. Columns: category label, `_` (Pearson r).

- `triplicate_cmc_pearsonr.tsv` 
- `triplicate_clinvar_pearsonr.tsv`
- `quintuplet_cmc_pearsonr.tsv`
- `quintuplet_clinvar_pearsonr.tsv`

### `{context}_{db}_pearsonr_corrected.tsv`
GC-corrected partial Pearson r between vIP and F for each category. Columns: category label, `partial_r`, `p_value`.

- `triplicate_cmc_pearsonr_corrected.tsv`
- `triplicate_clinvar_pearsonr_corrected.tsv`
- `quintuplet_cmc_pearsonr_corrected.tsv`
- `quintuplet_clinvar_pearsonr_corrected.tsv`